(function(t){function r(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var e={};return r.m=t,r.c=e,r.p="dist/",r(0)})([function(){var n,o,i,s=[].slice,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Batman.config.pathToHTML="/assets/batman/html",Batman.config.protectFromCSRF=!0,Batman.config.metaNameForCSRFToken="csrf-token",i=[1,2,3,4,5,6,7,10,11],o=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,Batman.Encoders.railsDate={encode:function(t){return t},decode:function(t){var e,r,n,s,a;if(null!=t){if(n=o.exec(t)){for(s=0,a=i.length;a>s;s++)e=i[s],n[e]=+n[e]||0;return n[2]=(+n[2]||1)-1,n[3]=+n[3]||1,"Z"!==n[8]&&void 0!==n[9]?(r=60*n[10]+n[11],"+"===n[9]&&(r=0-r)):r=new Date(n[1],n[2],n[3],n[4],n[5],n[6],n[7]).getTimezoneOffset(),new Date(Date.UTC(n[1],n[2],n[3],n[4],n[5]+r,n[6],n[7]))}return Batman.developer.warn("Unrecognized rails date "+t+"!"),Date.parse(t)}}},n={encodeTimestamps:function(){var t;return t=arguments.length>=1?s.call(arguments,0):[],0===t.length&&(t=["created_at","updated_at"]),this.encode.apply(this,s.call(t).concat([{encode:!1,decode:Batman.Encoders.railsDate.decode}]))},_encodesNestedAttributesForKeys:[],encodesNestedAttributesFor:function(){var t;return t=arguments.length>=1?s.call(arguments,0):[],this._encodesNestedAttributesForKeys=this._encodesNestedAttributesForKeys.concat(t)}},Batman.Model.encodeTimestamps=function(){return Batman.developer.warn("You must use Batman.RailsStorage to use encodeTimestamps. Use it with `@persist(Batman.RailsStorage)` in your model definition."),n.encodeTimestamps.apply(this,arguments)},Batman.RailsStorage=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.ModelMixin=Batman.mixin({},Batman.RestStorage.ModelMixin,n),e.prototype.urlForRecord=function(){return this._addJsonExtension(e.__super__.urlForRecord.apply(this,arguments))},e.prototype.urlForCollection=function(){return this._addJsonExtension(e.__super__.urlForCollection.apply(this,arguments))},e.prototype._addJsonExtension=function(t){return-1!==t.indexOf("?")||".json"===t.substr(-5,5)?t:t+".json"},e.prototype._errorsFrom422Response=function(t){var e;return e=JSON.parse(t),"errors"in e?e.errors:e},e.prototype.before("all",function(t,e){var r,n,o,i;return Batman.config.protectFromCSRF?(null==Batman.config.CSRF_TOKEN&&(Batman.config.CSRF_TOKEN=(n=Batman.DOM.querySelector(document.head,'meta[name="'+Batman.config.metaNameForCSRFToken+'"]'))?n.getAttribute("content"):null),(o=Batman.config.CSRF_TOKEN)&&(r=(i=t.options).headers||(i.headers={}),null==r["X-CSRF-Token"]&&(r["X-CSRF-Token"]=o)),e()):e()}),e.prototype.after("update","create",function(t,e){var r,n,o,i,s,a,u,c,p,l;if(s=t.subject,r=t.error,a=t.response,r&&r instanceof Batman.StorageAdapter.UnprocessableRecordError){try{c=this._errorsFrom422Response(a)}catch(h){return o=h,t.error=o,e()}for(i in c)for(n=c[i],p=0,l=n.length;l>p;p++)u=n[p],s.get("errors").add(i,u);return t.result=s,t.error=s.get("errors"),e()}return e()}),e.prototype.before("create","update",function(t,e){var r,n,o,i,s,a,u,c;if(s=t.subject.constructor._encodesNestedAttributesForKeys,!s.length)return e();for(n=this.serializeAsForm?t.options.data:JSON.parse(t.options.data),a=(i=this.recordJsonNamespace(t.subject))?n[i]:n,u=0,c=s.length;c>u;u++)o=s[u],null!=a[o]&&(r=a[""+o+"_attributes"]=a[o],delete a[o]);return this.serializeAsForm||(t.options.data=JSON.stringify(n)),e()}),e.prototype.after("update",e.skipIfError(function(t,e){var r,n,o,i,s,a,u;for(u=t.subject.constructor._encodesNestedAttributesForKeys,s=0,a=u.length;a>s;s++)i=u[s],n=t.subject.reflectOnAssociation(i),null==n?Batman.developer.error("No assocation was found for nested attribute "+i):n instanceof Batman.PluralAssociation?(o=t.subject.get(i),o.forEach(function(t){return t.get("_destroy")?(o.remove(t),t.constructor.get("loaded").remove(t)):void 0})):n instanceof Batman.SingularAssociation&&t.subject.get(""+i+"._destroy")&&(r=t.subject.get(i),r.isProxy&&(r=r.get("target")),t.subject._withoutDirtyTracking(function(){return this.set(i,null)}),n.getRelatedModel().get("loaded").remove(r));return e()})),e}(Batman.RestStorage)}]);